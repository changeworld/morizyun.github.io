<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: elasticsearch | 酒と泪とRubyとRailsと]]></title>
  <link href="http://morizyun.github.io/blog/categories/elasticsearch/atom.xml" rel="self"/>
  <link href="http://morizyun.github.io/"/>
  <updated>2016-01-02T22:08:36+09:00</updated>
  <id>http://morizyun.github.io/</id>
  <author>
    <name><![CDATA[morizyun]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Elasticsearch 2.1 + Kibana 4.1 + Marvel のMacへのセットアップ]]></title>
    <link href="http://morizyun.github.io/blog/elasticsearch-kibana-setup-mac/"/>
    <updated>2016-01-02T21:40:00+09:00</updated>
    <id>http://morizyun.github.io/blog/elasticsearch-kibana-setup-mac</id>
    <content type="html"><![CDATA[<p><a href="http://www.amazon.co.jp/gp/product/B00MPDUQQI/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=247&creative=1211&creativeASIN=B00MPDUQQI&linkCode=as2&tag=morizyun00-22"><img border="0" src="http://ws.assoc-amazon.jp/widgets/q?_encoding=UTF8&ASIN=B00MPDUQQI&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=morizyun00-22" width="150" style="float: left; margin: 0 20px 20px 0;" ></a><img src="http://www.assoc-amazon.jp/e/ir?t=morizyun00-22&l=as2&o=9&a=B00MPDUQQI" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<ul>
<li>全文検索エンジンの『<strong><a href="https://www.elastic.co/products/elasticsearch">Elasticsearch 2.1</a></strong>』</li>
<li>Elasticsearchのデータ表示のツール『<strong><a href="https://www.elastic.co/products/kibana">Kibana 4.1.4</a></strong>』</li>
<li>Elasticsearchの管理ツール『<strong><a href="https://www.elastic.co/products/marvel">Marvel</a></strong>』</li>
</ul>


<p>をMac Yosemiteに環境構築する手順をまとめました。</p>

<!-- more -->


<br style="clear:both;"/>


<p><div>
  <script type="text/javascript"><!--
  google_ad_client = "ca-pub-4186413323075068";
  /* middle_yoko_naga2 */
  google_ad_slot = "4362325392";
  google_ad_width = 728;
  google_ad_height = 90;
  //-->
  </script>
  <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</div></p>

<h2>Elasticsearchとは</h2>

<p>ElasticSearchは、Apache Lucene 上で稼働するオープンソースの全文検索システムのことです。
REST APIを使うことができ、jsonでやり取りを行う事ができる。</p>

<h2>Elasticsearch のインストール</h2>

<p>Macの場合は、まずはJavaのインストールです。
<strong><a href="http://www.amazon.co.jp/gp/bestsellers/computers/2151977051/ref=pd_zg_hrsr_computers_1_3_last">Java SE - Downloads | Oracle</a></strong>
からファイルをダウンロードして、インストールします。</p>

<p>次に『<strong><a href="https://www.elastic.co/downloads/past-releases/">Download Elasticsearch | Elastic</a></strong>』からファイルをダウンロードします。</p>

<p>今回は Elasticsearchの 1.7.4をインストールします。理由は、2.0系からsha1のチェックを行うそうなんですが、
plugin系が必ずしも対応していないようです。今回は日本語対応の kuromojiをつかたかったので、少し古いバージョンを使っています。</p>

<p>```ruby
brew install elasticsearch</p>

<h1>自動起動の設定</h1>

<p>ln -sfv /usr/local/opt/elasticsearch/*.plist ~/Library/LaunchAgents
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.elasticsearch.plist
```</p>

<h2>日本語対応で elasticsearch-analysis-kuromoji をインストール</h2>

<p>ターミナルで以下を実行。</p>

<p><code>
plugin install analysis-kuromoji
</code></p>

<p><code>vi config/elasticsearch.yml</code>でファイルを開いて以下を追加。デフォルトで kurmoji を使うようにします。</p>

<p>```</p>

<h6>############################ Custom</h6>

<h1>Using kuromoji in default</h1>

<p>index.analysis.analyzer.default.type: custom
index.analysis.analyzer.default.tokenizer: kuromoji_tokenizer
```</p>

<p>以下が動作確認の手順です。</p>

<p><code>
$ curl -XPUT http://0.0.0.0:9200/dummy/test/1 -d '{"tag": "foo", "text": "bar"}'
{"_index":"dummy","_type":"test","_id":"1","_version":1,"created":true}
</code></p>

<h2>データビジュアライゼーション Kibana</h2>

<p>ミーハーなので データのビジュアライゼーションツール『<strong><a href="https://www.elastic.co/products/kibana">Kibana</a></strong>』
もインストールします。後で使うかもくらいですww</p>

<p>まずはnodeとnmpが必要となります。もしまだの場合は、
『<strong><a href="http://qiita.com/tagosaku324/items/bf1fe149c38c99728c72">macでNode.jsの環境設定 - Qiita</a></strong>』
を参考にしながらインストールしてみてください。</p>

<p>```ruby</p>

<h1>npm を最新にします</h1>

<p>npm update</p>

<p>wget https://download.elastic.co/kibana/kibana/kibana-4.1.4-darwin-x64.zip
unzip kibana-4.1.4-darwin-x64.zip
mv kibana-4.1.4-darwin-x64 kibana
cd kibana</p>

<h1>kibana のサーバを起動</h1>

<p>bin/kibana
```</p>

<p><code>http://localhost:5601/</code> にアクセスするとKibanaの画面が見れると思います。</p>

<p><img src="https://farm6.staticflickr.com/5659/23996427772_e8904e5b3a.jpg" width="500" height="340"></p>

<p>こんな感じの画面が見れれば成功だと思います！</p>

<h2>Elasticsearchの管理プラグイン Mervel</h2>

<p>つづいて、Elasticsearchの管理プラグイン「<strong><a href="https://www.elastic.co/products/marvel">Marvel</a></strong>」をインストールします。
クラスタやインデックスのキャッシュヒット、ドキュメント数などを閲覧できます。</p>

<p><code>
plugin install elasticsearch/marvel/latest
</code></p>

<p><code>http://localhost:9200/_plugin/marvel</code> にアクセスすると Marvelの画面が見れ得ると思います。</p>

<p><img src="https://farm2.staticflickr.com/1461/23828851120_b45ed81acf.jpg" width="500" height="435"></p>

<p>「Dashboard > Sense」と選択すると画面から簡単にクエリを実行できます！</p>

<p><img src="https://farm2.staticflickr.com/1451/23498091433_13eab6cbf2.jpg" width="500" height="341"></p>

<h2>おまけ</h2>

<p>Elasticsearchのクラスタ情報等のフロントエンドには、
『<strong><a href="https://github.com/mobz/elasticsearch-head">mobz/elasticsearch-head - GitHub</a></strong>』
もあります。結構便利です。</p>

<h2>ありがとうございました！</h2>

<blockquote class="twitter-tweet" lang="ja"><p lang="ja" dir="ltr"><a href="https://twitter.com/zyunnosuke">@zyunnosuke</a> 2.xからはkuromojiのインストールはこのようになっています。1.7を選択した理由はそれ以外にもあるんでしょうか？ <a href="https://t.co/M3DOakc4Um">https://t.co/M3DOakc4Um</a></p>&mdash; Jun Ohtani (@johtani) <a href="https://twitter.com/johtani/status/683263779988082688">2016, 1月 2</a></blockquote>


<script async src="http://morizyun.github.io//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>ということで、 [@johtani]さんのおかげで、無事2.1系で手順をかけました。ありがとうございました＾＾</p>

<br style="clear:both;"/>


<p><div>
  <script type="text/javascript"><!--
  google_ad_client = "ca-pub-4186413323075068";
  /* middle_yoko_naga2 */
  google_ad_slot = "4362325392";
  google_ad_width = 728;
  google_ad_height = 90;
  //-->
  </script>
  <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</div></p>

<h2>Special Thanks</h2>

<ul>
<li><strong><a href="http://qiita.com/watermint/items/fc04baa184be8cbfb251">Using ELK(ElasticSearch 1.4.2 + Logstash 1.4.2 + Kibana 4 Beta3) - Qiita</a></strong></li>
<li><strong><a href="http://qiita.com/atsuya046/items/c53987153487f05e31fd">MacでElasticsearch(1.5.x) + Kuromojiをインストール - Qiita</a></strong></li>
<li><strong><a href="http://ruby-rails.hatenadiary.com/entry/20151018/1445142266">RailsでElasticsearch: 全文検索を実装 - Rails Webook</a></strong></li>
</ul>

]]></content>
  </entry>
  
</feed>
