<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Mongodb | 酒と泪とRubyとRailsと]]></title>
  <link href="http://morizyun.github.io/blog/categories/mongodb/atom.xml" rel="self"/>
  <link href="http://morizyun.github.io/"/>
  <updated>2015-12-30T21:03:25+09:00</updated>
  <id>http://morizyun.github.io/</id>
  <author>
    <name><![CDATA[morizyun]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[MongoDBをMac Yosemiteにインストール]]></title>
    <link href="http://morizyun.github.io/blog/mongodb-install-setup-mac/"/>
    <updated>2015-03-16T10:00:00+09:00</updated>
    <id>http://morizyun.github.io/blog/mongodb-install-setup-mac</id>
    <content type="html"><![CDATA[<p><a href="http://www.amazon.co.jp/gp/product/B00ITFOFLS/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=247&creative=1211&creativeASIN=B00ITFOFLS&linkCode=as2&tag=morizyun00-22"><img border="0" src="http://ws.assoc-amazon.jp/widgets/q?_encoding=UTF8&ASIN=B00ITFOFLS&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=morizyun00-22" width="150" style="float: left; margin: 0 20px 20px 0;" ></a><img src="http://www.assoc-amazon.jp/e/ir?t=morizyun00-22&l=as2&o=9&a=B00ITFOFLS" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
MongoDBはドキュメント思考のデータベース(NoSQLの一種)です。
開発の初期段階で、RailsでMongoDB/mongoidを使うとスキーマが固まっていない段階でDBを意識せずに開発が進められます。
うまくユースケースにハマりそうな場合は、ぜひ使ってみてください＾＾</p>

<!-- more -->


<br style="clear:both;"/>


<p>{% include custom/google_ads_yoko_naga.html %}</p>

<h2>MongoDBをインストール手順</h2>

<p>Homebrewのアップデート。</p>

<p>{% codeblock lang:bash %}
brew update
{% endcodeblock %}</p>

<p>mongodbのインストール。</p>

<p>{% codeblock lang:bash %}
brew install mongodb
{% endcodeblock %}</p>

<p>自動起動設定。</p>

<p>{% codeblock lang:bash %}</p>

<h1>起動スクリプトのシンボリックリンク追加</h1>

<p>ln -sfv /usr/local/opt/mongodb/*.plist ~/Library/LaunchAgents</p>

<h1>自動起動をさせたい場合はこちら</h1>

<p>launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mongodb.plist</p>

<h1>もし自動起動をしたくない場合に手動で起動する場合はこちら</h1>

<p>mongod --config /usr/local/etc/mongod.conf
{% endcodeblock %}</p>

<p>mongodbの動作確認。</p>

<p>{% codeblock lang:bash %}
mongo</p>

<blockquote><p>MongoDB shell version: 3.0.0
connecting to: test
Welcome to the MongoDB shell.
For interactive help, type "help".
For more comprehensive documentation, see
  http://docs.mongodb.org/
Questions? Try the support group
  http://groups.google.com/group/mongodb-user</p>

<p>{% endcodeblock %}</p></blockquote>

<p>dbの切り替え。</p>

<p>{% codeblock lang:bash %}
use mydb</p>

<blockquote><p>switched to db mydb
{% endcodeblock %}</p></blockquote>

<p>データの登録テスト。</p>

<p>{% codeblock lang:bash %}
j = { name : "mongo" };</p>

<blockquote><p>{ "name" : "mongo" }</p></blockquote>

<p>db.things.save(j);
db.things.find();</p>

<blockquote><p>{ "_id" : ObjectId("503ae94fb29f5c1529443919"), "name" : "mongo" }
{% endcodeblock %}</p></blockquote>

<p>シンプル &amp; 便利！</p>

<p>{% include custom/google_ads_yoko_naga.html %}</p>

<h2>補足</h2>

<p><a href="http://www.cuspy.org/diary/2012-04-17">MongoDBの薄い本(The Little MongoDB Book)</a>は、MongoDBを実際に手を動かして学ぶことができる無料のチュートリアル本です。</p>

<p><a href="http://www.cuspy.org/diary/2012-04-17" title="fpu_tmp_1353921432.4884_59f4bc by morizyun, on Flickr"><img src="http://farm9.staticflickr.com/8057/8219449049_f555a10dae.jpg" width="243" height="344" alt="fpu_tmp_1353921432.4884_59f4bc"></a></p>

<p>オススメです！</p>

<h2>Special Thanks</h2>

<p><a href="http://www.mongodb.org/display/DOCSJP/%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB#%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB-%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E5%8F%96%E5%BE%97">チュートリアル | mongoDB 公式 日本語</a></p>

<h2>変更来歴</h2>

<p>(2012-11-12 17:00) 新規作成<br/>
(2014-03-16 10:00) Yosemiteでインストール<br/></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Herokuの超優良アドオン MongoLabを Rails 4.0 x Ruby 2.1環境で使う！]]></title>
    <link href="http://morizyun.github.io/blog/mongolab-mongodb-mongoid-rails/"/>
    <updated>2013-12-28T20:00:00+09:00</updated>
    <id>http://morizyun.github.io/blog/mongolab-mongodb-mongoid-rails</id>
    <content type="html"><![CDATA[<p>Herokuの超優良アドオンの一つであるMongoLabは、HerokuでMongoDBを0.5GBまで無料で使えるアドオンです。公式のPostgreSQLの無料枠が1万レコードまで
なのでかなり太っ腹なサービスです。</p>

<p><img src="http://farm9.staticflickr.com/8207/8221004350_8482265b9d.jpg" width="500" height="311" alt="fpu_tmp_1353937227.5696_c84f0e"></p>

<p>今回は久々にMongoLabを触ったので、ついでにRails 4 x Ruby 2.1での動作確認がてら記事をリニュアールしました！</p>

<!-- more -->


<p>{% include custom/google_ads_yoko_naga.html %}</p>

<h2>Rails プロジェクト作成</h2>

<p>プロジェクトを作成する。今回はmongoidを利用するので、ActiveRecordをスキップ。(-Oオプションを付ける)</p>

<p>{% codeblock lang:bash %}
rails new test-app -O --skip-test-unit --skip-bundle
{% endcodeblock %}</p>

<p>Gitリポジトリ作成を作成します。</p>

<p>{% codeblock コンソール lang:bash %}
git init
git add -A
git commit -m "create new project"
{% endcodeblock %}</p>

<p><code>Gemfile</code>に以下の内容を追加して、<code>bundle install</code>を実行。
(mongoidのバージョンはalpha版なので是非確認を<a href="https://github.com/mongoid/mongoid/releases">Releases · mongoid/mongoid</a>)</p>

<p>{% codeblock lang:ruby %}
ruby '2.1.0'</p>

<h1>Mongoid</h1>

<p>gem 'mongoid', '4.0.0.alpha1' # 最新バージョンをGitHubで確認して下さい
gem 'bson_ext'
gem 'origin'
gem 'moped'
{% endcodeblock %}</p>

<h2>mongoDBに接続するための設定を作成</h2>

<p>mongoDBの設定ファイルを生成。</p>

<p>{% codeblock lang:bash %}
rails generate mongoid:config
{% endcodeblock %}</p>

<p>生成された設定ファイル<code>config/mongoid.yml</code>にmongolabのURLを取得するように設定を修正。</p>

<p>{% codeblock lang:bash %}
production:
  sessions:</p>

<pre><code>default:
  uri: &lt;%= ENV['MONGOLAB_URI'] %&gt;
</code></pre>

<p>{% endcodeblock %}</p>

<h2>scaffoldを実行</h2>

<p>{% codeblock lang:bash %}
rails g scaffold article title:string
{% endcodeblock %}</p>

<p><code>config/routes.rb</code>ファイルを修正。</p>

<p>{% codeblock lang:ruby %}
root :to => 'articles#index'
{% endcodeblock %}</p>

<h2>HerokuにPush</h2>

<p>まずは変更分をコミット。</p>

<p>{% codeblock lang:bash %}
git add -A
git commit -m "add scaffold"
{% endcodeblock %}</p>

<p>続いてheroku上にアプリを生成。</p>

<p>{% codeblock lang:bash %}
heroku create test-app --stack cedar
{% endcodeblock %}</p>

<p>MongoLabのAddonを追加。</p>

<p>{% codeblock lang:bash %}
heroku addons:add mongolab
{% endcodeblock %}</p>

<p>Herokuへのデプロイ。</p>

<p>{% codeblock コンソール lang:bash %}
git push heroku master
{% endcodeblock %}</p>

<p>結果をブラウザで確認。</p>

<p><img src="http://farm9.staticflickr.com/8483/8220837210_6fca1b4415.jpg" width="500" height="291" alt="fpu_tmp_1353932567.9166_43a8ae"></p>

<p>ちなみにheroku addonsとしてのmongolabの便利機能。</p>

<p>{% codeblock lang:bash %}</p>

<h1>mongolabのドキュメントをブラウザで表示</h1>

<p>heroku addons:docs mongolab</p>

<h1>mongolabの管理画面(データの追加などできます)</h1>

<p>heroku addons:open mongolab
{% endcodeblock %}</p>

<p>ちなみに、<code>heroku addons:open mongolab</code>を実行するとローカルのターミナルからmongolabに接続するためのコマンドがわかるので、ローカルからの開発もかなり捗ります！</p>

<p><img src="http://farm6.staticflickr.com/5507/11600816073_6bcb2799fb_z.jpg"></p>

<h2>今回のソース</h2>

<p>今回作成したサンプルソースです。もしつまっちゃうようならぜひお試しください！</p>

<p><a href="https://github.com/morizyun/mongolab-heroku" class="button big primary">Source(GitHub)</a></p>

<p>{% include custom/google_ads_yoko_naga.html %}</p>

<h2>補足</h2>

<p>次のようなエラーが発生する場合は、</p>

<pre>
ActionView::Template::Error (undefined method `[]' for nil:NilClass)
</pre>


<p>Gemfileにrubyのバージョンを指定すると解決しました〜</p>

<p><a href="http://stackoverflow.com/questions/3613948/how-can-i-choose-ruby-version-on-heroku">How can I choose Ruby version on Heroku?</a></p>

<h2>変更来歴</h2>

<p>(12/28 20:20) Rails 4.0 x Ruby 2.1対応</p>
]]></content>
  </entry>
  
</feed>
