<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Android | 酒と泪とRubyとRailsと]]></title>
  <link href="http://morizyun.github.io/blog/categories/android/atom.xml" rel="self"/>
  <link href="http://morizyun.github.io/"/>
  <updated>2016-01-12T23:54:18+09:00</updated>
  <id>http://morizyun.github.io/</id>
  <author>
    <name><![CDATA[morizyun]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Realm Swift/objective-C/Android用のデータベース]]></title>
    <link href="http://morizyun.github.io/blog/realm-swift-database-ios-smartphone/"/>
    <updated>2015-06-21T18:40:00+09:00</updated>
    <id>http://morizyun.github.io/blog/realm-swift-database-ios-smartphone</id>
    <content type="html"><![CDATA[<p><a href="http://www.amazon.co.jp/gp/product/4797371145/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=247&creative=1211&creativeASIN=4797371145&linkCode=as2&tag=morizyun00-22"><img border="0" src="http://ws.assoc-amazon.jp/widgets/q?_encoding=UTF8&ASIN=4797371145&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=morizyun00-22" width="150" style="float: left; margin: 0 20px 20px 0;" ></a><img src="http://www.assoc-amazon.jp/e/ir?t=morizyun00-22&l=as2&o=9&a=4797371145" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />Swiftやobjective-Cなどを使ったiOSのアプリ開発や、
Javaを使ったAndroid開発で使えるローカルデータベースとして最近人気がある『<strong><a href="https://realm.io/jp/">Realm</a></strong>』の紹介です。</p>

<p>今回はまだ触り始めたばかりであまり知見もないので、紹介記事へのリンクをメインにします。</p>

<!-- more -->


<br style="clear:both;"/>


<p>{% include custom/google_ads_square.html %}</p>

<h2>Realmの特徴</h2>

<pre>
* 使い方が簡単
* ゼロコピーの設計なので速い
* iOS、Androidでクロスプラットフォーム
</pre>


<h2>リンク集</h2>

<h3>公式ドキュメント</h3>

<p><strong><a href="https://realm.io/jp/docs/swift/latest/">Swift Docs - Realm is a mobile database: a replacement for SQLite &amp; Core Data</a></strong></p>

<p>公式ドキュメント。日本人のコミッターもいるそうで、とにかくドキュメントがわかりやすいのも特徴の一つ。</p>

<h3>Realm for Swift まとめ完全版</h3>

<p><strong><a href="http://qiita.com/okitsutakatomo/items/9134c5fa8bd4384a2acf">Realm for Swift まとめ完全版</a></strong></p>

<p>これだけ読んでも簡単な使い方ならわかるほどクオリティの高いまとめ。素晴らしすぎる。</p>

<h3>Realmを使ってデータ管理</h3>

<p><strong><a href="http://qiita.com/jtemplej/items/0443571fdbffbcea3e7f">Objective-C - Realmを使ってデータ管理【Swift編】-その2- - Qiita</a></strong><br/>
<strong><a href="http://qiita.com/jtemplej/items/10ed4bc0cc6519682e6e">iOS - Realmを使ってデータ管理【Swift編】-その3- - Qiita</a></strong></p>

<p>こちらもQiitaの記事ですが、Realmを使ってデータ管理するときに使いそうな細かいTipsが書かれている。Qiita素敵！</p>

<p>{% include custom/google_ads_square.html %}</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Android 開発 完全初心者向けの入門資料]]></title>
    <link href="http://morizyun.github.io/blog/android-studio-java-beginner/"/>
    <updated>2015-03-15T13:10:00+09:00</updated>
    <id>http://morizyun.github.io/blog/android-studio-java-beginner</id>
    <content type="html"><![CDATA[<p><a href="http://www.amazon.co.jp/gp/product/4774169986/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=247&creative=1211&creativeASIN=4774169986&linkCode=as2&tag=morizyun00-22"><img border="0" src="http://ws.assoc-amazon.jp/widgets/q?_encoding=UTF8&ASIN=4774169986&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=morizyun00-22" width="150" style="float: left; margin: 0 20px 20px 0;" ></a><img src="http://www.assoc-amazon.jp/e/ir?t=morizyun00-22&l=as2&o=9&a=4774169986" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
Androidのアプリ開発の勉強を始めたので、読んでいる入門資料や書籍を中心にまとめてみました。
こういう完全アウェーな開発の場合はドットインストールの動画にはめちゃくちゃ助けられます、premium動画素晴らしい！</p>

<!-- more -->


<br style="clear:both;"/>


<p>{% include custom/google_ads_square.html %}</p>

<h2>環境構築</h2>

<h3>Java 入門</h3>

<p>Androidの前にJavaに入門したい人には、拙著『<strong><a href="/blog/java-introduction-code-style/">Java 初心者向け資料を全力でまとめてみた！</a></strong>』がオススメです！</p>

<h3>ドットインストール: Androidアプリ開発入門</h3>

<p><strong><a href="http://dotinstall.com/lessons/basic_android">Androidアプリ開発入門 (全12回) - プログラミングならドットインストール</a></strong></p>

<p>環境構築は初心者が一番つまづきやすいポイントですが、動画を見ながらなのでほぼつまらずに一気にHello Worldが出来ました！</p>

<h3>MacでAndroidアプリ開発！「Android Studio」を使ってみる</h3>

<p><strong><a href="http://saku-java.be-ourselves.jp/2014/03/11/mac-android-studio-install/">MacでAndroidアプリ開発！「Android Studio」を使ってみる 〜その1 インストール〜</a></strong><br/>
<strong><a href="http://saku-java.be-ourselves.jp/2014/03/13/mac-android-studio-start-app-and-create-emulator/">MacでAndroidアプリ開発！「Android Studio」を使ってみる 〜その3 Androidエミュレータ作成、アプリ起動〜 | サクッとJava研修室</a></strong><br/></p>

<p>エミュレータの設定などの部分を中心に文字で読みたい場合にはこちらがおすすめ。スクリーンショットが多いのでわかりやすいです！</p>

<p><strong><a href="http://androidstudio.hatenablog.com/entry/2014/07/21/143425">Android Studioでアプリを実機で動作確認する - Android Studioでアプリ開発！</a></strong><br></p>

<p>もし実機を持っているなら、実機デバックが操作感もわかっておすすめです。ということでAndroid Studioで実機デバックする手順です。以外と簡単！</p>

<h2>Android 開発入門</h2>

<p><strong><a href="http://www.techinstitute.jp/material/01/">Tech Institute Android アプリ開発者養成講座テキスト</a></strong></p>

<p>アプリ開発者のためのプログラミングスクール Tech Institute さんの教材資料。
950ページに及ぶ、充実したテキスト！</p>

<p><strong><a href="http://dotinstall.com/lessons/basic_android_layout">【Premium】Androidレイアウト入門 (全8回) - ドットインストール</a></strong></p>

<p>月額980円かかるドットインストールのPremium動画ですが、十分その価値はあります。画面サイズがばらばらなAndroidでの
開発前に抑えておきたいポイントを勉強する事ができます。</p>

<p><strong><a href="http://dotinstall.com/lessons/basic_android_listview">【Premium】Androidリストビュー入門 (全21回) - ドットインストール</a></strong></p>

<p>同じく、月額980円かかるドットインストールのPremium動画。Androidのリストビュー(ListView)を作る際に必要な考え方について学ぶことができます。</p>

<p><strong><a href="http://dotinstall.com/lessons/omikuji_android">【Premium】Androidでおみくじアプリを作ろう (全7回) - プログラミングならドットインストール</a></strong></p>

<p>同じく、月額980円かかるドットインストールのPremium動画。おみくじであれば、DB等も使わないので、シンプルですがアプリの作り方をイメージすることができる面白い動画でした！</p>

<p><strong><a href="http://dotinstall.com/lessons/basic_android_db">【Premium】Androidデータベース入門 (全25回) - ドットインストール</a></strong></p>

<p>月額980円かかるドットインストールのPremium動画。Androidでデータベースを扱っていく方法について学ぶ事ができます。
これだけだとDB操作をするときの概念を理解しきれませんが、どういったフローなのかは概略をつかむことができます。</p>

<h2>mixi-inc/AndroidTraining</h2>

<p><strong><a href="https://github.com/mixi-inc/AndroidTraining">mixi-inc/AndroidTraining - GitHub</a></strong></p>

<p>MixiさんがGitHubで公開しているAndroid アプリ開発の基礎知識と実務スキルを身に付けるトレーニングコース。
めちゃくちゃ品質が高いので、下手な書籍よりもよっぽどオススメです。素晴らしい時代や。</p>

<h2>コーディング規約</h2>

<p><strong><a href="http://qiita.com/Sam/items/4b4c53c9e616a39c7c70">Androidのコード規約について考えてみた - Qiita</a></strong><br/>
<strong><a href="https://github.com/cookpad/styleguide/blob/master/java.ja.md">styleguide/java.ja.md at master · cookpad/styleguide</a></strong></p>

<p>初心者のうちからコーディング規約を読んでおくのは結構大切！と思い読んでいます。</p>

<h2>チュートリアル</h2>

<p><strong><a href="http://eure.jp/blog/android-app-for-beginners-1/">初心者必見！10時間で作るはじめてのAndroidアプリ−前編 | 株式会社エウレカ</a></strong></p>

<p>サーバーとの通信も必要でちょっと難しめのアプリですが、写経しながら実用的なAndroidアプリの作り方を知ることができる、素晴らしいチュートリアルです！</p>

<h2>お願い</h2>

<p>もしオススメの入門資料や書籍をお見かけしたら、ぜひコメントお願いします！</p>

<p>{% include custom/google_ads_square.html %}</p>

<h2>変更来歴</h2>

<p>(2015-03-15 13:10) Tech Institute Android アプリ開発者養成講座テキスト を追加<br/></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ActiveAndroid Android/JavaでActiveRecord風にsqliteを使う]]></title>
    <link href="http://morizyun.github.io/blog/activeandroid-andcroid-java-gradle/"/>
    <updated>2014-11-24T08:35:00+09:00</updated>
    <id>http://morizyun.github.io/blog/activeandroid-andcroid-java-gradle</id>
    <content type="html"><![CDATA[<p><a href="http://www.amazon.co.jp/gp/product/479813192X/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=247&creative=1211&creativeASIN=479813192X&linkCode=as2&tag=morizyun00-22"><img border="0" src="http://ws.assoc-amazon.jp/widgets/q?_encoding=UTF8&ASIN=479813192X&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=morizyun00-22" width="150" style="float: left; margin: 0 20px 20px 0;" ></a><img src="http://www.assoc-amazon.jp/e/ir?t=morizyun00-22&l=as2&o=9&a=479813192X" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />AndroidのsqliteをActiveRecord風に使うためのライブラリ
『<strong><a href="https://github.com/pardom/ActiveAndroid">ActiveAndroid</a></strong>』のインストールに手こずったのでそのメモです。
インストールさえ完了すれば、かなりわかりやすいライブラリなのでこれから重宝しそうです＾＾</p>

<!-- more -->


<br style="clear:both;"/>


<p>{% include custom/google_ads_square.html %}</p>

<h2>前提</h2>

<p>Android 4.4 / Android Studioで開発中です。</p>

<h2>jarファイルの生成</h2>

<p>以下のコマンドを実行してjarファイルを生成。</p>

<p>{% codeblock lang:bash %}
git clone https://github.com/pardom/ActiveAndroid.git
cd ActiveAndroid
sh gradlew build
{% endcodeblock %}</p>

<p>生成したjarファイルを<code>app/libs</code>にコピー。</p>

<p>{% codeblock lang:bash %}
cp ActiveAndroid/build/libs/* /android/path/to/app/libs
{% endcodeblock %}</p>

<h2>Gradleファイルの設定</h2>

<p><code>app/build.gradle</code>の中に以下を追加。</p>

<p>{% codeblock lang:bash %}
dependencies {
  # ↓ この行を追加
  compile 'com.android.support:appcompat-v7:+'
}
{% endcodeblock %}</p>

<h2>AndroidManifest.xmlに設定</h2>

<p><code>AndroidManifest.xml</code>に次の設定を行います！</p>

<pre>
(1) applicationタグに android:name="com.activeandroid.app.Application" を追記。
(2) applicationタグの中にmeta-tagに AA_DB_NAME と AA_DB_VERSION を追記。
</pre>


<p>ということでサンプルはこんな感じです。</p>

<p>{% codeblock lang:xml %}
<manifest ...>
  <application android:name="com.activeandroid.app.Application" ...></p>

<pre><code>&lt;meta-data android:name="AA_DB_NAME" android:value="application.db" /&gt;
&lt;meta-data android:name="AA_DB_VERSION" android:value="1" /&gt;
</code></pre>

<p>  </application>
</manifest>
{% endcodeblock %}</p>

<h2>テーブル定義の設定</h2>

<p>まずはテーブル定義を設定。これはシンプル！</p>

<p>{% codeblock lang:java %}
// テーブル名の定義
@Table(name = "Items")
public class Item extends Model {
  // フィールドの定義
  @Column(name = "Name")
  public String name;</p>

<p>  @Column(name = "Category")
  public Category category;</p>

<p>  // コンストラクタの定義
  public Item(){</p>

<pre><code>super();
</code></pre>

<p>  }</p>

<p>  public Item(String name, Category category) {</p>

<pre><code>super();
this.name = name;
this.category = category;
</code></pre>

<p>  }
}
{% endcodeblock %}</p>

<p>さらにテーブル間のリレーションの定義とかは本家GitHubのWikiがわかりやすいのでオススメです！</p>

<p><strong><a href="https://github.com/pardom/ActiveAndroid/wiki/Creating-your-database-model">Creating your database model · pardom/ActiveAndroid Wiki</a></strong></p>

<h2>レコードの新規作成して保存(insert)</h2>

<p>新規レコードを作成して保存するinsert文。かなり直感的。</p>

<p>{% codeblock lang:java %}
// Itemテーブルのレコードを作成
Item item = new Item();
item.name = "Outback Steakhouse";</p>

<p>// 作成したレコードを保存
item.save();
{% endcodeblock %}</p>

<p>テーブル間のリレーションを設定して保存したり、Bulk insertしたり、レコードを削除したりは本家GitHubのWikiに詳しく書いてあります。</p>

<p><strong><a href="https://github.com/pardom/ActiveAndroid/wiki/Creating-your-database-model">Creating your database model · pardom/ActiveAndroid Wiki</a></strong></p>

<h2>レコードの検索</h2>

<p>テーブルに保存したレコードを検索する場合はこちら。</p>

<p>{% codeblock lang:java %}
// nameの一致するレコードを1件取得
public static Item getItemByName(String name) {
  return new Select()</p>

<pre><code>.from(Item.class)
.where("Name = ?", name)
.executeSingle();
</code></pre>

<p>}</p>

<p>// List形式で複数件のレコードを取得
public static List<Item> getAllByName(String name) {
  return new Select()</p>

<pre><code>.from(Item.class)
.where("Name = ?", name)
.orderBy("Name ASC")
.execute();
</code></pre>

<p>}
{% endcodeblock %}</p>

<h2>Date型をつかえるようにする / Type serializers</h2>

<p>sqliteで扱えるのは、<code>INTEGER, REAL, TEXT, BLOB</code>だけだそうです。
ですが、Date型を保存したいことって結構あると思います。そんな時に便利なのが、<code>TypeSerializer</code>です。</p>

<p>ここでは、Date型をDBに保存するときにはLong型にして、DBから取り出したらDate型に戻してくれるクラスを作ります。</p>

<p>{% codeblock lang:java %}
import com.activeandroid.serializer.TypeSerializer;
import java.util.Date;</p>

<p>final public class UtilDateSerializer extends TypeSerializer {
  @Override
  public Class&lt;?> getDeserializedType() {</p>

<pre><code>return Date.class;
</code></pre>

<p>  }</p>

<p>  @Override
  public Class&lt;?> getSerializedType() {</p>

<pre><code>return Long.class;
</code></pre>

<p>  }</p>

<p>  @Override
  public Long serialize(Object data) {</p>

<pre><code>if (data == null) {
  return null;
}

return ((Date) data).getTime();
</code></pre>

<p>  }</p>

<p>  @Override
  public Date deserialize(Object data) {</p>

<pre><code>if (data == null) {
  return null;
}

return new Date((Long) data);
</code></pre>

<p>  }
}
{% endcodeblock %}</p>

<p>作成が完了したら、<code>AndroidManifest.xml</code>に次の設定を追加！</p>

<p>{% codeblock lang:xml %}
<manifest ...>
  <application android:name="com.activeandroid.app.Application" ...></p>

<pre><code>// ↓ 追加する行
&lt;meta-data android:name="AA_SERIALIZERS" android:value="パッケージ名.UtilDateSerializer" /&gt;
</code></pre>

<p>  </application>
</manifest>
{% endcodeblock %}</p>

<h2>更に使いこなすために</h2>

<p><strong><a href="https://github.com/pardom/ActiveAndroid/wiki/Creating-your-database-model">Creating your database model · pardom/ActiveAndroid Wiki</a></strong></p>

<p><strong><a href="http://dev.classmethod.jp/smartphone/android/activeandroid/">ActiveAndroid を使って ActiveRecord ライクに SQLite を操作する</a></strong></p>

<p><strong><a href="http://moonstruckdrops.github.io/blog/2013/12/19/active-android/">ActiveAndroidを使ってみた - kurobaraのブログ</a></strong></p>

<h2>Android Studioで原因不明のエラーが出続ける場合</h2>

<p>Eclipseは使ったことないですが、Android StudioでBuildすると結構な確率でエラーが出て積むことがあります。
そんな、初心者な方のために今日覚えたコマンドを書いておきます。</p>

<pre>
(1) File ----> Invalidate caches/restart
(2) Build -> Clean project
</pre>


<p>かなりハマりましたorz...</p>

<p>{% include custom/google_ads_square.html %}</p>

<h2>Special Thanks</h2>

<p><strong><a href="http://stackoverflow.com/questions/21458956/how-to-add-activeandroid-orm-to-gradle">How to add ActiveAndroid ORM to Gradle?</a></strong></p>

<p><strong><a href="https://teamtreehouse.com/forum/android-app-has-error-execution-failed-taskapppredexdebug-trying-to-test-parse-but-cant-run-app-with-this-error">Android app has error: Execution failed task':app:preDexDebug' trying to test parse but can't run app with this error | Treehouse Forum</a></strong></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Garage RailsでOauth認証付きのRest APIをお手軽開発！]]></title>
    <link href="http://morizyun.github.io/blog/garage-gem-ruby-restful-hypermedia-api/"/>
    <updated>2014-11-18T22:10:00+09:00</updated>
    <id>http://morizyun.github.io/blog/garage-gem-ruby-restful-hypermedia-api</id>
    <content type="html"><![CDATA[<p><a href="http://www.amazon.co.jp/gp/product/4873116864/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=247&creative=1211&creativeASIN=4873116864&linkCode=as2&tag=morizyun00-22"><img border="0" src="http://ws.assoc-amazon.jp/widgets/q?_encoding=UTF8&ASIN=4873116864&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=morizyun00-22" width="150" style="float: left; margin: 0 20px 20px 0;" ></a><img src="http://www.assoc-amazon.jp/e/ir?t=morizyun00-22&l=as2&o=9&a=4873116864" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
CookpadさんがOSSで先日OSSで公開されたGarageはRestfulなAPI + Oauth(Doorkeeper)をワンストップで提供してくれるgemです。
ちょうど触る機会が出てきたので、今回四苦八苦しながら使ってみたのでそのメモです！</p>

<!-- more -->


<br style="clear:both;"/>


<p>{% include custom/google_ads_square.html %}</p>

<h2>今回のサンプル実装</h2>

<p>今回はOauthで認証して、以下のシンプルなAPIにアクセスできるようにするまでのサンプルを作成します。</p>

<pre>
GET /v1/users => ユーザーのリスト出力
GET /v1/users/:id => 個々のユーザー情報の出力
</pre>


<h2>Gemの追加</h2>

<p><code>Gemfile</code>に以下を追加して、<code>bundle install</code>。</p>

<p>{% codeblock lang:ruby %}
gem 'garage', github: 'cookpad/garage'
gem 'responders', '~> 2.0' # If you use Rails4.2+</p>

<p>group :development, :test do
  gem 'factory_girl_rails', '~> 4.5.0'
  gem 'rspec-rails', '~> 3.1.0'
end
{% endcodeblock %}</p>

<h2>DBの設定(Migration)</h2>

<p>GagrageやRspecの初期設定とか、マイグレーションとかを実行。</p>

<p>{% codeblock lang:bash %}</p>

<h1>Doorkeeper(Oauth認証)の初期設定</h1>

<p>$ bundle exec rails generate doorkeeper:install</p>

<h1>Doorkeeper(Oauth認証)のMigrationファイル生成</h1>

<p>$ bundle exec rails generate doorkeeper:migration</p>

<h1>DBの作成</h1>

<p>$ bundle exec rake db:create</p>

<h1>認証用のユーザーモデル作成</h1>

<p>$ bundle exec rails g model user name:string email:string</p>

<h1>マイグレーション処理の実行</h1>

<p>$ bundle exec rake db:migrate
{% endcodeblock %}</p>

<h2>Garageの設定</h2>

<p><code>config/initializers/garage.rb</code>を作成して、Garageの設定を記述。</p>

<p>{% codeblock lang:ruby %}
Garage.configure {}</p>

<p>Garage::TokenScope.configure do
  register :public, desc: 'accessing publicly available data' do</p>

<pre><code>access :read,   User
access :write,  User
</code></pre>

<p>  end
end</p>

<p>Doorkeeper.configure do
  orm :active_record</p>

<p>  # デフォルトのスコープ
  default_scopes :public</p>

<p>  optional_scopes(*Garage::TokenScope.optional_scopes)</p>

<p>  # アプリケーションのオーナーの認証
  resource_owner_from_credentials do |routes|</p>

<pre><code>User.find_by(email: params[:username])
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<h2>ルーティングの設定</h2>

<p><code>config/routes.rb</code>にルーティングを追記。</p>

<p>{% codeblock lang:ruby %}
Rails.application.routes.draw do
  use_doorkeeper</p>

<p>  scope :v1 do</p>

<pre><code>resources :users, only: %i(index show update)
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<h2>コントローラの作成</h2>

<p><code>app/controllers/application_controller.rb</code>に共通の設定を追記。</p>

<p>{% codeblock lang:ruby %}
class ApplicationController &lt; ActionController::Base
  # ↓ 以下追記する内容
  include Garage::ControllerHelper</p>

<p>  def current_resource_owner</p>

<pre><code>@current_resource_owner ||= User.find(resource_owner_id) if resource_owner_id
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<p><code>app/controllers/users_controller.rb</code>を作成して、設定を追記。</p>

<p>{% codeblock lang:ruby %}
class UsersController &lt; ApplicationController
  include Garage::RestfulActions</p>

<p>  # index
  def require_resources</p>

<pre><code>@resources = User.all
</code></pre>

<p>  end</p>

<p>  # show
  def require_resource</p>

<pre><code>@resources = User.find(params[:id])
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<h2>モデルの設定</h2>

<p>更に<code>app/models/user.rb</code>にモデルの設定を追記。</p>

<p>{% codeblock lang:ruby %}
class User &lt; ActiveRecord::Base
  include Garage::Representer
  include Garage::Authorizable</p>

<p>  property :id
  property :name
  property :email</p>

<p>  # index
  def self.build_permissions(perms, other, target)</p>

<pre><code>perms.permits! :read
</code></pre>

<p>  end</p>

<p>  # create/update/show/destory
  def build_permissions(perms, other)</p>

<pre><code>perms.permits! :read
perms.permits! :write
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<h2>動作確認</h2>

<p>{% codeblock lang:bash %}</p>

<h1>テストユーザーの作成</h1>

<p>$ bundle exec rails runner 'User.create(name: "morizyun", email: "morizyun@example.com")'</p>

<h1>サーバーの起動</h1>

<p>$ bundle exec rails s
{% endcodeblock %}</p>

<p><strong><a href="http://localhost:3000/oauth/applications">http://localhost:3000/oauth/applications</a></strong></p>

<p>上のURLにアクセスして、テスト用のクライアントを登録します。
登録したら、<code>APPLICTION_ID</code>と<code>APPLICATION_SECRET</code>を登録します。</p>

<p>{% codeblock lang:bash %}</p>

<h1>APPLICTION_IDとAPPLICATION_SECRETを使って、ACCESS_TOKENを取得</h1>

<p>curl -u "$APPLICTION_ID:$APPLICATION_SECRET" -XPOST http://localhost:3000/oauth/token -d 'grant_type=password&amp;username=morizyun@example.com'</p>

<h1>上で取得したACCESS_TOKENを使ってAPIでuserの一覧を取得</h1>

<p>curl -s -XGET -H "Authorization: Bearer $ACCESS_TOKEN" http://localhost:3000/v1/users | jq '.'</p>

<h1>上で取得したaccess_tokenを使ってAPIでuserの一覧を取得</h1>

<p>curl -s -XGET -H "Authorization: Bearer $ACCESS_TOKEN" http://localhost:3000/v1/users/1 | jq '.'
{% endcodeblock %}</p>

<h2>より複雑な処理のためにテストを書く</h2>

<p>ここから更に複雑な処理を記述するために、RSpecでテストを記述できるようにします。</p>

<h2>RSpecの設定</h2>

<p>RSpecの設定。</p>

<p>{% codeblock lang:bash %}</p>

<h1>RSpecの初期設定</h1>

<p>$ bundle exec rails g rspec:install
{% endcodeblock %}</p>

<h2>spec_helper.rbの設定</h2>

<p><code>spec/spec_helper.rb</code>にFactoryGirl関連の設定を追加。</p>

<p>{% codeblock lang:ruby %}
require 'factory_girl_rails'</p>

<p>RSpec.configure do |config|
  config.before :all do</p>

<pre><code>FactoryGirl.reload
FactoryGirl.factories.clear
FactoryGirl.sequences.clear
FactoryGirl.find_definitions
</code></pre>

<p>  end</p>

<p>  config.include FactoryGirl::Syntax::Methods</p>

<p>  config.expect_with :rspec do |expectations|</p>

<pre><code>expectations.include_chain_clauses_in_custom_matcher_descriptions = true
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<h2>request_helper.rbの設定</h2>

<p>RSpec実行時にOauthの認証処理を予めやってくれて、access_tokenを取得してくれるhelperの作成。
<code>spec/request_helper.rb</code>を作成して以下を追加。</p>

<p>{% codeblock lang:bash %}
require 'active_support/concern'</p>

<p>module RequestHelper
  extend ActiveSupport::Concern</p>

<p>  included do</p>

<pre><code>let(:params) { {} }

let(:report_status_env) do
  {
      accept: 'application/json',
      authorization: report_status_authorization_header_value
  }
end

let(:report_status_authorization_header_value) { "Bearer #{report_status_access_token.token}" }

let(:report_status_access_token) do
  FactoryGirl.create(
      :access_token,
      resource_owner_id: resource_owner.id,
      scopes: public,
      application: application
  )
end

let(:resource_owner) { FactoryGirl.create(:user) }
let(:report_status_scopes) { 'public' }
let(:application) { FactoryGirl.create(:application) }
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<h2>FactoryGirl(Fixture)の設定</h2>

<p><code>spec/factories/users.rb</code>で以下を追加。</p>

<p>{% codeblock lang:ruby %}
FactoryGirl.define do
  factory :user do</p>

<pre><code>name "MyString"
email "MyString"
sequence(:name) {|n| "user#{n}" }
email { "#{name}@example.com" }
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<p>Doorkeeper用の設定として、<code>spec/factories/doorkeeper.rb</code>を追加。</p>

<p>{% codeblock lang:ruby %}
FactoryGirl.define do
  factory :access_token, class: Doorkeeper::AccessToken do</p>

<pre><code>sequence(:resource_owner_id) { |n| n }
application
expires_in 1.hours
</code></pre>

<p>  end</p>

<p>  factory :application, class: Doorkeeper::Application do</p>

<pre><code>sequence(:name){ |n| "Application #{n}" }
redirect_uri 'https://example.com/callback'
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<h2>Specファイルの作成</h2>

<p><code>spec/requests/users_spec.rb</code>を以下の様に変更。</p>

<p>{% codeblock lang:ruby %}
require 'rspec_helper'
require 'request_helper'</p>

<p>RSpec.describe 'users', type: :request do
  include RequestHelper</p>

<p>  describe 'GET /v1/users' do</p>

<pre><code>let!(:users) { create_list(:user, 3) }

it 'returns user resources' do
  get '/v1/users', params, env
  expect(response).to have_http_status(200)
end
</code></pre>

<p>  end
end
{% endcodeblock %}</p>

<h2>RSpecの実施</h2>

<p>{% codeblock lang:bash %}</p>

<h1>Test環境用のDBの作成</h1>

<p>$ RAILS_ENV=test bundle exec rake db:create migrate</p>

<h1>migrationの実施</h1>

<p>$ RAILS_ENV=test bundle exec rake db:migrate</p>

<h1>users_specの実施</h1>

<p>$ bundle exec rspec -fp spec/requests/users_spec.rb
{% endcodeblock %}</p>

<h2>ここから使いこなすのに参考になりそうな資料</h2>

<p>CookpadさんのTech Blog の解説記事です。かなりわかりやすいですし、APIを作る時に参考になります＾＾</p>

<p><strong><a href="http://techlife.cookpad.com/entry/2014/11/06/100000">RESTful Web API 開発をささえる Garage - クックパッド開発者ブログ</a></strong></p>

<p>Cookpadのエンジニアさんが作ってくれているサンプルのおかげでかなり捗りました！</p>

<p><strong><a href="https://github.com/taiki45/garage-example">taiki45/garage-example - GitHub</a></strong></p>

<h2>Special Thanks</h2>

<p><strong><a href="http://qiita.com/217/items/389de32ac340de81d532">RESTful Hypermedia APIをRailsで実現するcookpad/garageが凄い - Qiita</a></strong></p>

<p>{% include custom/google_ads_square.html %}</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[短期アルバイトを10秒で探せるiPhone/Androidアプリ「Short.Works」を作っています！]]></title>
    <link href="http://morizyun.github.io/blog/short.works-parttimer-sidejob-iphone-app/"/>
    <updated>2014-07-31T12:05:00+09:00</updated>
    <id>http://morizyun.github.io/blog/short.works-parttimer-sidejob-iphone-app</id>
    <content type="html"><![CDATA[<p><a href="https://short.works/"><img src="https://farm4.staticflickr.com/3921/14790220145_5a116b8000_z.jpg" width="640" height="388" alt="short.works"></a></p>

<p>短期のアルバイトを10秒で探して、応募ができるiPhone/Androidアプリ『<strong><a href="https://short.works/">Short.Works</a></strong>』を個人開発しています。
現時点としてはWebサイト・iPhone/Androidアプリを開発中の状態ですが、ヒアリング、デザイン・開発などにご協力頂ける個人・企業様を探したくてティザーサイトを作りました。<br/>
(つまり、今回は個人開発の広告的記事ですw)</p>

<p>(8/8 16:25) Androidも合わせて9月リリースを目標に変更して開発しています！</p>

<!-- more -->


<br style="clear:both;"/>


<p>{% include custom/google_ads_square.html %}</p>

<h2>きっかけ</h2>

<p>堀江貴文さんが首都圏コンピュータ技術者株式会社（MCEA)の25周年の講演でお話をされていた記事、『<strong><a href="http://engineer.typemag.jp/article/horie-mcea">「世界が変わらないのはエンジニアのせいでもある」堀江貴文氏がフリーエンジニアに向けて放つ5つの提言 - エンジニアtype</a></strong>』の中でこんなフレーズがありました。</p>

<blockquote>
社会全体が古くさいシステムに囚われている
</blockquote>


<p>ハードも含めてオープン化が着実に進行して、エンジニアが簡単に実現できることはどんどん増えているのに、エンジニアとして僕は今まで「言われたもの」ばかり作ってきたなと考えさせられました。</p>

<p>また、『<strong><a href="http://www.engineyard.co.jp/blog/2014/software-is-not-soft/">Rubyの言語開発者 Matz(まつもとゆきひろ)さんが、第3回Rubyビジネスフォーラムの基調講演</a></strong>』で紹介されていた『スノーボールエフェクト』という言葉、すげー好きです。
僕も「<strong>自分ができるスノーボールを作り続けよう</strong>」と強く思いました。</p>

<p>あとは身近なところではこの前、卓球ハウスで行われた『<strong><a href="http://nekova.hatenablog.com/entry/2014/06/28/200324">個人開発を支える技術Night</a></strong>』に行って、めちゃくちゃ刺激を受けたからってのも大きいです。</p>

<p>実際にやってて、個人開発楽しい！です。</p>

<h2>このサービスで実現したいこと</h2>

<p>まずは、「このサービスで実現したいこと・想い」を書きます。
大きくまとめると、次の３つのファクターだと思います。</p>

<pre>
* ソーシャル上の「つながり」を通じて、友達や知り合いにアルバイトが拡がる
* 空いてる時間に「ボタンひとつ」で「すぐ」にアルバイトが見つかる
* スケジュールを登録すると、自分にあったアルバイトがレコメンドされる
</pre>


<p>ちょっと言い換えると、「<strong>ソーシャル・グットなアルバイトが自然に広がる</strong>」極めてシンプルなアプリを作りたいッス。</p>

<p>あとマーケティング的にまずはベータ版の期間中は『<strong>完全無料</strong>』でアルバイトの募集ができるようにするつもりです！のでそちらもご期待頂ければ幸いです。</p>

<h2>大風呂敷</h2>

<p>この記事を書いていてテンションが上がって、できるだけ大風呂敷を広げたいなってことで将来夢見ている機能なんかも一緒に書いておきますw</p>

<pre>
* CtoCの頼み事なんかもソーシャル・グットにできるといいな
* シニア世代の人にでも簡単に使えるUIにしていきたい
* 多言語化しで誰でも・どこでも、アルバイトを始められるようにしたい
* 個人の経験、専門性が自然に積み重なって、マッチングの質が高まるようにしたい
</pre>


<p>一応補足っす。この辺りの法律関係は非常に厳しいのは重々承知しておりますので、どうか生暖かく見守って頂ければ幸いです。</p>

<h2>お願い事項</h2>

<p>ということでここが一番言いたかったことですw</p>

<p>次のような方がいらっしゃったら、<a href="mailto:contact@short.works"/>contact@short.works</a>か<a href="https://twitter.com/shortworkus">Twitter@shortworkus</a>にメッセージ下さい。</p>

<pre>
1) アルバイト募集がしたい企業様
   (御社に伺って触ってアプリ・管理画面のデモ版を触って頂きながらお話したいです)

2) 短期のアルバイトの経験をお持ちの方
   (ご都合のいいカフェかどこかで、お茶飲みながらユーザーレビューさせてください)

3) iPhone / Railsアプリの開発に興味を持って頂ける方

4) スマホや管理画面のUI/UXのデザインにご協力頂ける方

5) マーケティングにご協力頂ける方
</pre>


<p>半日〜１日だけとか週末プロジェクトとか、ガッツリやってみたいとかもまずはメッセージ頂ければ幸いです。
報酬もテンポラリー、レベニューシェア、その他もろもろ何でも相談に乗ります！まずは何でも言ってください。</p>

<h2>あとがき</h2>

<p>もしiPhoneアプリ『<strong><a href="https://short.works/">Short.Works</a></strong>』の最新情報を知りたい場合は</p>

<p>Twitterアカウント: <strong><a href="https://twitter.com/shortworkus">@shortworkus</a></strong></p>

<p>Facebookページ: <strong><a href="https://www.facebook.com/short.work.us">https://www.facebook.com/short.work.us</a></strong></p>

<p>をフォローして頂けると幸いです。宜しくお願い致します！</p>

<p>{% include custom/google_ads_square.html %}</p>
]]></content>
  </entry>
  
</feed>
